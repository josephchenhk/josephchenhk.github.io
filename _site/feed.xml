<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.7">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-07-19T16:46:46+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Joseph Chen</title><subtitle>A blog about Joseph</subtitle><entry><title type="html">Git Submodules</title><link href="http://localhost:4000/git-submodules/" rel="alternate" type="text/html" title="Git Submodules" /><published>2022-07-19T00:00:00+08:00</published><updated>2022-07-19T00:00:00+08:00</updated><id>http://localhost:4000/git-submodules</id><content type="html" xml:base="http://localhost:4000/git-submodules/">&lt;head&gt;
    &lt;script src=&quot;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    &lt;/script&gt;
&lt;/head&gt;

&lt;p&gt;&lt;strong&gt;Starting with Submodules&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Let’s start by adding an existing Git repository as a submodule of the repository that we’re working on.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git submodule add https://github.com/josephchenhk/qtrader
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Afrter this, you should notice the new .gitmodules file. This is a configuration file that stores the mapping between the project’s URL and the local subdirectory you’ve pulled it into:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[submodule &quot;qtrader&quot;]
	path = qtrader
	url = https://github.com/josephchenhk/qtrader
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When you commit, you see something like this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git commit -am 'Add qtrader module'
[master fb9093c] Add qtrader module
 2 files changed, 4 insertions(+)
 create mode 100644 .gitmodules
 create mode 160000 qtrader
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Notice the 160000 mode for the qtrader entry. That is a special mode in Git that basically means you’re recording a commit as a directory entry rather than a subdirectory or a file.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Cloning a Project with Submodules&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;When you clone such a project with a submodule, by default you get the directories that contain submodules, but none of the files within them yet:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git clone https://github.com/josephchenhk/qtrader_strategies
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qtrader&lt;/code&gt; directory is there, but empty. You must run two commands: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule init&lt;/code&gt; to initialize your local configuration file, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule update&lt;/code&gt; to fetch all the data from that project and check out the appropriate commit listed in your superproject:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git submodule init
$ git submodule update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively, you can pass &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--recurse-submodules&lt;/code&gt; to the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git clone&lt;/code&gt; command, it will automatically initialize and update each submodule in the repository, including nested submodules if any of the submodules in the repository have submodules themselves.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git clone --recurse-submodules https://github.com/josephchenhk/qtrader_strategies
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you already cloned the project and forgot &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--recurse-submodules&lt;/code&gt;, you can combine the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule init&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule update&lt;/code&gt; steps by running &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule update --init&lt;/code&gt;. To also initialize, fetch and checkout any nested submodules, you can use the foolproof &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule update --init --recursive&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Working on a Project with Submodules&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Now we have a copy of a project with submodules in it and will collaborate with our teammates on both the main project (e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qtrader_strategies&lt;/code&gt;) and the submodule project (e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;qtrader&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Pulling in Upstream Changes from the Submodule Remote&lt;/em&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Simply go into the directory and run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git fetch&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git merge&lt;/code&gt; the upstream branch to update the local code.&lt;/li&gt;
  &lt;li&gt;Alternatively, you can run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule update --remote&lt;/code&gt;, and Git will go into your submodules and fetch and update for you. By default the master/main branch is tracked and updated, if you want to specify a different branch &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dev&lt;/code&gt;, you can config in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.gitmodules&lt;/code&gt; file: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git config -f .gitmodules submodule.qtrader.branch dev&lt;/code&gt; (in this way, everyone else also tracks it)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;em&gt;Pulling Upstream Changes from the Project Remote&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Simply executing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git pull&lt;/code&gt; to get your newly committed changes is not enough. To finalize the update, you need to run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule update&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git pull
$ git status

$ git submodule update --init --recursive
$ git status
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;$\color{blue}{\textbf{Note}}$ that to be on the safe side, you should run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git submodule update&lt;/code&gt; with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--init&lt;/code&gt; flag in case the qtrader_strategies commits you just pulled added new submodules, and with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--recursive&lt;/code&gt; flag if any submodules have nested submodules.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Working on a Submodule&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Usually we want to work on both the main project and the submodule(s).&lt;/p&gt;

&lt;p&gt;First of all, let’s go into our submodule directory and check out a branch.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd qtrader/
$ git checkout dev
Switched to branch 'dev'

$ cd ..
$ git submodule update --remote --merge (or --rebase)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you forget the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--rebase&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--merge&lt;/code&gt;, Git will just update the submodule to whatever is on the server and reset your project to a detached HEAD state.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Publishing Submodule Changes&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The git push command takes the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--recurse-submodules&lt;/code&gt; argument which can be set to either “check” or “on-demand”. The “check” option will make push simply fail if any of the committed submodule changes haven’t been pushed.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git push --recurse-submodules=check
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you want the check behavior to happen for all pushes, you can make this behavior the default by doing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git config push.recurseSubmodules check&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The other option is to use the “on-demand” value, which will try to do this for you (equivalent to manully git push in each submodule).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Further reference&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://git-scm.com/book/en/v2/Git-Tools-Submodules&quot;&gt;Git Tools - Submodules&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Stationary Time Series Tests</title><link href="http://localhost:4000/stationary_time_series_test/" rel="alternate" type="text/html" title="Stationary Time Series Tests" /><published>2021-05-28T09:55:00+08:00</published><updated>2021-05-28T09:55:00+08:00</updated><id>http://localhost:4000/stationary_time_series_test</id><content type="html" xml:base="http://localhost:4000/stationary_time_series_test/">&lt;head&gt;
    &lt;script src=&quot;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    &lt;/script&gt;
&lt;/head&gt;

&lt;p&gt;In the previous &lt;a href=&quot;https://josephchenhk.github.io/sample-mean-and-variance/&quot;&gt;post&lt;/a&gt;, we investigated the population mean and variance, and the sample mean and variance. We also understand what is an unbiased estimator of the population variance. Now we are going to look for ways to test for mean reversion on time series using the Python programming language, which will give us the basic toolbox to deal with cointegration in future posts.&lt;/p&gt;

&lt;h1 id=&quot;mean-reversion-process&quot;&gt;Mean Reversion Process&lt;/h1&gt;
&lt;p&gt;Mathematically, a continuous mean-reverting time series can be represented by an Ornstein-Uhlenbeck stochastic differential equation in the following form:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} \label{ou-eq}
dx_t = \theta(\mu - x_t)dt + \sigma dW_t
\end{equation}&lt;/script&gt;

&lt;p&gt;Where $\theta$ is the rate of reversion to the mean, $\mu$ is the mean value of the process, $\sigma$ is the standard deviation (and $\sigma^2$ is the variance) of the process and, finally, $W_t$ is a Wiener process. The given equation implies that the change of the time series in the next period is proportional to the difference between the mean and the current value, with the addition of Gaussian noise.&lt;/p&gt;

&lt;p&gt;In discrete form, this OU equation is given as (just let $\Delta t=1$, and change differentiaon to $\Delta$)&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} 
\Delta x_t = \theta(\mu - x_{t-1}) + \sigma \Delta W_t
\end{equation}&lt;/script&gt;

&lt;p&gt;where $\Delta x_t = x_t - x_{t-1}$.&lt;/p&gt;
&lt;h1 id=&quot;augmented-dickey-fuller-test&quot;&gt;Augmented Dickey-Fuller Test&lt;/h1&gt;
&lt;p&gt;The Augmented Dickey-Fuller test provides a quick check and confirmatory evidence that your time series is stationary or non-stationary. We should take into account that is a statistical test, and as such it can only be used to inform the degree to which a null hypothesis can be accepted or rejected. So the given result must be interpreted to be meaningful.&lt;/p&gt;

&lt;p&gt;The ADF test is based on the simple observation that if the value level is higher than the mean, the next move will be downward while if the value is lower than the mean, the next move will be upward.&lt;/p&gt;

&lt;p&gt;We can describe the value changes with the following linear model:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} 
\Delta x_t = \lambda x_{t-1} + \mu + \beta t + \alpha_1 \Delta x_{t-1} + ... + \alpha_k \Delta x_{t-k}  + \epsilon_t
\end{equation}&lt;/script&gt;

&lt;p&gt;where $\Delta x(t) = x(t) - x(t-1)$, $\Delta x(t-1) = x(t-1) - x(t-2)$ and so on.&lt;/p&gt;

&lt;p&gt;The function of the ADF is to test if $\lambda = 0$. &lt;strong&gt;If the hypothesis $\lambda = 0$ can be rejected&lt;/strong&gt;, that means the next move $\Delta x(t)$ depends on the current level $x(t-1)$ and so &lt;strong&gt;it is not a random walk&lt;/strong&gt;. The test statistic is the regression coeficient $\lambda$ divided by the standard error of the regression fit:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} 
DF = \frac{\lambda }{SE(\lambda)}
\end{equation}&lt;/script&gt;

&lt;p&gt;Dickey and Fuller have already calculated the distribution of this test statistic, which allows us to determine the rejection of the hypothesis for any chosen percentage critical value. Since we expect mean regression to be negative (i.e., $\lambda$ is expected to be negative here if this is a mean-reverting time series) and it has to be more negative than the critical value for the hypothesis to be rejected.&lt;/p&gt;

&lt;p&gt;We can simply interpret the result using the p-value from the test. A p-value below a specified threshold (we are going to use 5%) suggests we reject the null hypothesis (stationary), otherwise a p-value above the threshold suggests we accept the null hypothesis (non-stationary).&lt;/p&gt;

&lt;p&gt;A naive implementation of the ADF test in Python is shown here:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import numpy as np
from statsmodels.regression.linear_model import OLS
from statsmodels.tsa.tsatools import lagmat, add_trend
from statsmodels.tsa.adfvalues import mackinnonp

def adf(ts, maxlag:int=None):
    &quot;&quot;&quot;
    Augmented Dickey-Fuller unit root test

    tsdall[explanatory variable] (maxlag=3 as an example)
    * 1st column(tsdall[:,0]): [x3, x4, ..., x_{t-2}, x_{t-1}] are X variables (corresponding to coefficient *lambda*)
    * 2nd column(tsdall[:,1]): [x3-x2, x4-x3, ..., x_{t-2}-x_{t-3}, x_{t-1}-x_{t-2}] are X variables (corresponding to coeff *alpha_1*)
    * 3rd column(tsdall[:,2]): [x2-x1, x3-x2, ..., x_{t-3}-x_{t-4}, x_{t-2}-x_{t-3}] are X variables (corresponding to coeff *alpha_2*)
    * 4th column(tsdall[:,3]): [x1-x0, x2-x1, ..., x_{t-4}-x_{t-3}, x_{t-3}-x_{t-4}] are X variables (corresponding to coeff *alpha_3*)

    tsdshort[response variable]:
    * [x4-x3, x5-x4, ..., x_{t-1}-x_{t-2}, x_t-x_{t-1}] are the Y variables

    Regression:
    * x4-x3 = lambda*x3 + alpha1*(x3-x2) + alpha2*(x2-x1) + alpha3*(x1-x0) + mu + epsilon
    * x5-x4 = lambda*x4 + alpha1*(x4-x3) + alpha2*(x3-x2) + alpha3*(x2-x1) + mu + epsilon
    * ...
    * x_t-x_{t-1} = lambda*x_{t-1} + alpha1*(x_{t-1}-x_{t-2}) + alpha2*(x_{t-2}-x_{t-3}) + alpha3*(x_{t-3}-x_{t-4}) + mu + epsilon
    &quot;&quot;&quot;
    # Maximum lag which is included in test, default 12*(nobs/100)^{1/4} 
    # Ref: https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html
    if maxlag is None:
        maxlag = int(np.ceil(12 * (len(ts) / 100) ** (1 / 4)))

    # make sure we are working with an array, convert if necessary
    ts = np.asarray(ts)

    # Calculate the discrete difference
    tsdiff = np.diff(ts)

    # Create a 2d array of lags, trim invalid observations on both sides
    tsdall = lagmat(tsdiff[:, None], maxlag, trim='both', original='in')

    # Get dimension of the array
    nobs = tsdall.shape[0]

    # [explanatory variable] replace first column ([:,0]) xdiff with level of x
    tsdall[:, 0] = ts[-nobs - 1:-1]

    # [response variable]
    tsdshort = tsdiff[-nobs:]

    # Calculate the linear regression using an ordinary least squares model
    results = OLS(tsdshort, add_trend(tsdall[:, :maxlag + 1], 'c')).fit()

    # adfstat = DF = lambda / SE(lambda)
    adfstat = results.tvalues[0]

    # Get approx p-value from a precomputed table (from stattools)
    pvalue = mackinnonp(adfstat, 'c', N=1)

    return adfstat, pvalue
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For the verification of our implementation we can compare the output of our implementation with the result of the function adfuller, included in the Python module statsmodels from the SciPy ecosystem, when used with the same input:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;from statsmodels.tsa.stattools import adfuller

# Create a mean-reverting time series
np.random.seed(2021)
random_noise = np.random.randn(9999) / 100.
lambda_ = 0.2
mu = 5
y0 = 1
ts = [y0]
for n in range(9999):
    y1 = y0 + mu -lambda_*y0 + random_noise[n]
    ts.append(y1)
    y0 = y1

# ADF tests
print(&quot;ADF implemented:&quot;)
print(adf(ts))

print(&quot;ADF in statsmodels:&quot;)
print(adfuller(ts, autolag=None)) # autolag set to None to use maxlag
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The results show that our implementation is consistent with adfuller method in statsmodels:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ADF implemented:
(-16.74395546457208, 1.351035439732185e-29)
ADF in statsmodels:
(-16.74395546457208, 1.351035439732185e-29, 38, 9961, {'1%': -3.4310066595695945, '5%': -2.861830204343065, '10%': -2.5669244706354584})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;hurst-exponent&quot;&gt;Hurst Exponent&lt;/h1&gt;
&lt;p&gt;It is also possible to &lt;em&gt;determine the stationary nature of the time series&lt;/em&gt; by measuring its speed of diffusion, because a stationary time series should diffuse from its initial value more slowly than a geometric random walk.&lt;/p&gt;

&lt;p&gt;We can model the speed by the variance:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{equation} 
\textbf{Var}(\tau) = \left&lt; |z(t+\tau) - z(t) |^2 \right&gt; = \frac{1}{T} \int^T_0 |z(t+\tau) - z(t) |^2 
\end{equation} %]]&gt;&lt;/script&gt;

&lt;p&gt;where $z$ is the observed values, $\tau$ is an arbitrary time lag, and $&amp;lt;…&amp;gt;$ is an average over all $t$’s. For a geometric random walk, we know that&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{equation} 
\left&lt; |z(t+\tau) - z(t) |^2 \right&gt; \sim \tau
\end{equation} %]]&gt;&lt;/script&gt;

&lt;p&gt;This relationship turns into an equality with some proportionally constant for a large value of $\tau$, but it may deviate for a small $\tau$. So if the time series is mean reverting this won’t hold.&lt;/p&gt;

&lt;p&gt;Now we have to introduce the Hurst exponent H:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{equation} 
\left&lt; |z(t+\tau) - z(t) |^2 \right&gt; \sim \tau^{2H}
\end{equation} %]]&gt;&lt;/script&gt;

&lt;p&gt;For a time series with a geometric random walk behaviour, $H=0.5$, for a mean reverting series, $H&amp;lt;0.5$, and, finally, for a trending series $H&amp;gt;0.5$. $H$ also is an indicator for the degree of mean reversion or trendiness: as $H$ decreases towards 0, the series is more mean reverting and as it increases towards 1, it is more trending.&lt;/p&gt;

&lt;p&gt;There are $\color{blue}{\textbf{various methods}}$  of implementing a Hurst Exponent, depending on the definition (calculation) of variance. We introduce two commonly used methods here. One is defining the variance as square of standard deviations; another one is defining variance as square of &lt;strong&gt;rescaled range&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;hurst-exponent-1&quot;&gt;Hurst exponent (1)&lt;/h2&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;def hurst_exponent_1(ts):
    &quot;&quot;&quot;Returns the Hurst Exponent of the time series vector ts
    Ref: 
    1. https://www.quantstart.com/articles/Basics-of-Statistical-Mean-Reversion-Testing/
    2. https://towardsdatascience.com/introduction-to-the-hurst-exponent-with-code-in-python-4da0414ca52e
    &quot;&quot;&quot;
    N = len(ts)
    min_lag = 2
    max_lag = 100
    lags = range(min_lag, max_lag+1)

    # Calculate the array of the variances of the lagged differences
    tau = [np.square(np.std(np.subtract(ts[lag:], ts[:-lag]))) for lag in lags]

    # Use a linear fit to estimate the Hurst Exponent (2*H)
    poly = np.polyfit(np.log(lags), np.log(tau), 1)

    # Return the Hurst exponent from the polyfit output
    return poly[0]/2.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;hurst-exponent-2&quot;&gt;Hurst exponent (2)&lt;/h2&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;def hurst_exponent_2(ts):
    &quot;&quot;&quot;Returns the Hurst Exponent of the time series vector ts
    Ref:
    1. https://en.wikipedia.org/wiki/Hurst_exponent
    &quot;&quot;&quot;
    # Convert into np.array if the original ts is not a np.array
    ts = np.array(ts)
    
    N = len(ts)
    min_lag = 10
    max_lag = int(np.floor(N/2))
    lags = range(min_lag, max_lag+1)

    # Calculate different rescaled ranges
    ARS = []
    for lag in lags:
        # divide ts into different samples
        num = int(np.floor(N/lag))
        RS = []
        for n in range(num):
            X = ts[n*lag:(n+1)*lag] 
            # [Important]: take lagged differences
            X_diff = X[1:] - X[:-1] # X_diff = np.diff(X)
            Y = X_diff - X_diff.mean()
            Z = np.cumsum(Y)
            R = Z.max() - Z.min()
            S = Y.std(ddof=1)
            RS.append(R/S)
        
        ARS.append(sum(RS)/len(RS))   
    
    # Note we are estimating rescaled range (RS), instead of
    # RS^2, so the factor 2 disappear here.
    poly = np.polyfit(np.log(lags), np.log(ARS), 1)
    return poly[0]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;half-life-of-mean-reversion&quot;&gt;Half-Life of Mean Reversion&lt;/h1&gt;
&lt;p&gt;Calculating the half-life of a mean reversion time series is very interesting because it gives us the measure of how long it takes to mean revert.
This measure is a way to interpret the $\lambda$ coefficient in the equation we have already seen:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} 
\Delta x_t = \lambda x_{t-1} + \mu + \color{red}{\beta t + \alpha_1 \Delta x_{t-1} + ... + \alpha_k \Delta x_{t-k}  }+ \epsilon_t
\end{equation}&lt;/script&gt;

&lt;p&gt;For this new interpretation we have to transform this discrete time series into a differential form while ignoring the drift $\color{red}{\beta t}$ and the lagged differences $\color{red}{\alpha_1 \Delta x_{t-1} , … , \alpha_k \Delta x_{t-k}  }$ and we get the following &lt;strong&gt;Ornstein-Uhlenbeck formula&lt;/strong&gt; for the mean reverting process:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} 
d x_t = (\lambda x_{t-1} + \mu)dt + d\epsilon_t
\end{equation}&lt;/script&gt;

&lt;p&gt;This form allows us to get an analytic solution for the $\color{blue}{\textbf{expected value}}$ of $x(t)$ (Note: $\textbf{E}\left(x(t)\right)=\textbf{E}\left(x(t-1)\right)$ here):&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\textbf{E}\left(x(t)\right) = x_0 \cdot\exp(\lambda t) - \frac{\mu}{\lambda}\cdot\left(1-\exp(\lambda t)\right)&lt;/script&gt;

&lt;p&gt;If $\color{blue}{\lambda \text{ is negative}}$ for a &lt;strong&gt;mean-reverting process&lt;/strong&gt;, the expected value of the value decays exponentially to the value $-\mu/\lambda$ with the half-life of decay being $log(2)/\lambda$.&lt;/p&gt;

&lt;p&gt;Finally, to calculate the half-life mean reversion test we can use this simple implementation in Python:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;def half_life(ts):  
    &quot;&quot;&quot; 
    Calculates the half life of a mean reversion
    &quot;&quot;&quot;
    # make sure we are working with an array, convert if necessary
    ts = np.asarray(ts)
    
    # delta = p(t) - p(t-1)
    delta_ts = np.diff(ts)
    
    # calculate the vector of lagged values. lag = 1
    lag_ts = np.vstack([ts[:-1], np.ones(len(ts[:-1]))]).T
   
    # calculate the slope of the deltas vs the lagged values 
    # Ref: https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html
    lambda_, const = np.linalg.lstsq(lag_ts, delta_ts, rcond=None)[0]

    # compute and return half life
    # negative sign to turn half life to a positive value
    return - np.log(2) / lambda_
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All this theory and practical examples in Python will help us to understand and master the concept of cointegration, which will be thoroughly discussed in a following post. Stay tuned!&lt;/p&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="systematic trading" /><category term="statistics" /><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Cointegration Time Series Tests</title><link href="http://localhost:4000/cointegration_time_series_test/" rel="alternate" type="text/html" title="Cointegration Time Series Tests" /><published>2021-05-28T09:55:00+08:00</published><updated>2021-05-28T09:55:00+08:00</updated><id>http://localhost:4000/cointegration_time_series_test</id><content type="html" xml:base="http://localhost:4000/cointegration_time_series_test/">&lt;head&gt;
    &lt;script src=&quot;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    &lt;/script&gt;
&lt;/head&gt;

&lt;p&gt;In a previous &lt;a href=&quot;https://josephchenhk.github.io/stationary_time_series_test/&quot;&gt;post&lt;/a&gt;, we examined the fundamental tools to test for stationarity on time series using Python. If we use the tools described in the article, we will very soon realise that most time series are neither stationary nor mean reverting. In this new article we are going to examine how we can test two (or more) non-stationary time series to check whether the combined value is stationary.&lt;/p&gt;

&lt;p&gt;This is where we should introduce the notion of $\color{blue}{\textbf{cointegration}}$ .&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;If we are able to find a stationary linear combination of several time series that are not themselves stationary, then these are called cointegrated.&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;We are going to see two different tests: the simpler &lt;strong&gt;Cointegrated Augmented Dickey-Fuller test (CADF)&lt;/strong&gt; will be useful for pairs only, but we can apply the &lt;strong&gt;Johansen test&lt;/strong&gt; to any number of time series.&lt;/p&gt;

&lt;h1 id=&quot;cointegrated-augmented-dickey-fuller-test&quot;&gt;Cointegrated Augmented Dickey-Fuller Test&lt;/h1&gt;
&lt;p&gt;In the previous post, we saw how the ADF and Variance Ratio can test a given time series for mean reversion and stationarity, but we don’t know the number of units o percentage we should use to combine them into the stationary basket of elements we are looking for.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;We have to be aware that just because a set of time series is cointegrating doesn’t mean that any random linear combination of the series will form a stationary basket of elements.&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;To easily create the test we can use the procedure by Engle and Granger, which can be defined as the following steps:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Determine the optimal hedge ratio by running a lineal regression fit between the two series.&lt;/li&gt;
  &lt;li&gt;Use the hedge computed in step 1 to form a portfolio.&lt;/li&gt;
  &lt;li&gt;Run a stationarity test on the portfolio created in step 2.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Taking advantage of the code already written in the previous article, we can write the test easily with the help of the numpy and statsmodels libraries in the following way:&lt;/p&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="systematic trading" /><category term="statistics" /><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Sample Mean and Variance</title><link href="http://localhost:4000/sample-mean-and-variance/" rel="alternate" type="text/html" title="Sample Mean and Variance" /><published>2021-05-26T09:52:38+08:00</published><updated>2021-05-26T09:52:38+08:00</updated><id>http://localhost:4000/sample-mean-and-variance</id><content type="html" xml:base="http://localhost:4000/sample-mean-and-variance/">&lt;head&gt;
    &lt;script src=&quot;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    &lt;/script&gt;
&lt;/head&gt;

&lt;h1 id=&quot;population&quot;&gt;Population&lt;/h1&gt;

&lt;p&gt;Suppose $\vec{X} $ is our population with $N$ elements:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\vec{X} = (X_1, X_2, X_3, ..., X_N)&lt;/script&gt;

&lt;p&gt;According to the definition of mean and variance, we can have:&lt;/p&gt;

&lt;p&gt;(1). population mean:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} \label{eq-pop-mean}
\mu = \textbf{E}(\vec{X}) = \frac{1}{N} \sum_{i=1}^{N}X_i
\end{equation}&lt;/script&gt;

&lt;p&gt;(2). population variance (thus standard deviation $\sigma$ is the square root of variance):&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} \label{eq-pop-var}
\sigma^2 = \textbf{Var}(\vec{X}) = \frac{1}{N} \sum_{i=1}^{N} \left( X_i-\mu \right)^2
\end{equation}&lt;/script&gt;

&lt;p&gt;From the definitions above, we have the following conclusion: the variance equals &lt;strong&gt;mean of square minus square of mean&lt;/strong&gt; (see &lt;a href=&quot;https://en.wikipedia.org/wiki/Variance&quot;&gt;variance&lt;/a&gt;):&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation*} 
\textbf{Var}(\vec{X})  = \textbf{E}(\vec{X}^2) - \left[\textbf{E}(\vec{X})  \right]^2
\end{equation*}&lt;/script&gt;

&lt;p&gt;&lt;strong&gt;Proof&lt;/strong&gt;&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align*} 
\textbf{Var}(\vec{X})  &amp;= \frac{1}{N} \sum_{i=1}^{N} \left( X_i-\mu \right)^2 \\
                                                &amp;= \frac{1}{N} \sum_{i=1}^{N} \left( X_i^2-2\cdot\mu\cdot X_i+\mu^2 \right) \\
																								&amp;= \frac{1}{N} \sum_{i=1}^{N} X_i^2-2\cdot\mu\cdot \frac{1}{N} \sum_{i=1}^{N}X_i+\frac{1}{N} \sum_{i=1}^{N}\mu^2  \\
																								&amp;= \frac{1}{N} \sum_{i=1}^{N} X_i^2-2\cdot\mu\cdot \mu+\mu^2  \\
																								&amp;= \frac{1}{N} \sum_{i=1}^{N} X_i^2-\mu^2  \\
																								&amp;= \textbf{E}(\vec{X}^2)-\left[\textbf{E}(\vec{X})  \right]^2  \\
\end{align*} %]]&gt;&lt;/script&gt;

&lt;p&gt;Q.E.D&lt;/p&gt;
&lt;h1 id=&quot;sample&quot;&gt;Sample&lt;/h1&gt;
&lt;p&gt;We can randomly take out some samples from our population. If we fix the sample size to be $n$ (where $n&amp;lt;=N$), then there will be $C_N^n = \frac{N!}{n!\cdot(N-n)!}$ distinct samples from our population $\vec{X}$.&lt;/p&gt;

&lt;p&gt;As a brief example, let’s say $N=4$, and $n=3$, then for a population $\vec{X} $:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\vec{X} = (X_1, X_2, X_3, X_4)&lt;/script&gt;

&lt;p&gt;we can take out &lt;em&gt;four&lt;/em&gt; distinct samples ($C_4^3 = 4$) as below (the probability of each is equal to $1/4$):&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;(X_1, X_2, X_3), (X_1, X_2, X_4), (X_1, X_3, X_4), (X_2, X_3, X_4)&lt;/script&gt;

&lt;p&gt;And for each sample, we are able to calculate the mean of the sample (just the same as population mean while treating the sample as a new population):&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align*} 
\bar{X}_{sm,1} &amp;= \frac{X_1 + X_2 + X_3} {3} \\ 
\bar{X}_{sm,2} &amp;= \frac{X_1 + X_2 + X_4} {3} \\
\bar{X}_{sm,3} &amp;= \frac{X_1 + X_3 + X_4} {3} \\
\bar{X}_{sm,4} &amp;= \frac{X_2 + X_3 + X_4} {3} 
\end{align*} %]]&gt;&lt;/script&gt;

&lt;p&gt;where $sm$ stands for &lt;em&gt;sample mean&lt;/em&gt;. For this &lt;strong&gt;distribution of sample mean&lt;/strong&gt;  &lt;script type=&quot;math/tex&quot;&gt;\vec{X}_{sm} = (\bar{X}_{sm,1} ,\bar{X}_{sm,2} ,\bar{X}_{sm,3} ,\bar{X}_{sm,4} )&lt;/script&gt;,   we can calculate its mean and variance:&lt;/p&gt;

&lt;p&gt;(3). mean of sample mean:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} \label{eq-samplemean-mean}
\mu_{sm} = \textbf{E}(\vec{X}_{sm} ) = \frac{1}{4} \sum_{i=1}^{4} \bar{X}_{sm,i} 
\end{equation}&lt;/script&gt;

&lt;p&gt;(4). variance of sample mean:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} \label{eq-samplemean-var}
\sigma_{sm}^2 = \textbf{Var}(\vec{X}_{sm} ) = \frac{1}{4} \sum_{i=1}^{4} \left( \bar{X}_{sm,i} -\mu_{sm} \right)^2
\end{equation}&lt;/script&gt;

&lt;p&gt;For the relations of the original population and the sample mean, we have the following two assertations:&lt;/p&gt;

&lt;p&gt;(5). &lt;span style=&quot;color:red&quot;&gt;&lt;em&gt;mean of sample mean = population mean&lt;/em&gt; &lt;/span&gt;&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} 
\mu_{sm} = \textbf{E}(\vec{X}_{sm} ) \color{blue}{=\textbf{E}(\vec{X})  = \mu}
\end{equation}&lt;/script&gt;

&lt;p&gt;(6). &lt;span style=&quot;color:red&quot;&gt;&lt;em&gt;variance of sample mean = population variance / sample size&lt;/em&gt; &lt;/span&gt;&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation} 
\sigma_{sm}^2 = \textbf{Var}(\vec{X}_{sm} ) \color{blue}{= \frac{\textbf{Var}(\vec{X}) }{n}=\frac{\sigma^2}{n} }
\end{equation}&lt;/script&gt;

&lt;p&gt;&lt;strong&gt;Proof&lt;/strong&gt;&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align*} 
\mu_{sm} &amp;= \textbf{E}(\vec{X}_{sm} )   \\
                     &amp;= \frac{1}{4} \sum_{i=1}^{4} \bar{X}_{sm,i}  \\
										 &amp;= \frac{1}{4} \left[ \frac{X_1 + X_2 + X_3} {3}  + \frac{X_1 + X_2 + X_4} {3} +  \frac{X_1 + X_3 + X_4} {3}  + \frac{X_2 + X_3 + X_4} {3}  \right] \\ 
										 &amp; = \frac{1}{4} \left( \frac{\color{green}{3}\cdot X_1 + \color{green}{3} \cdot X_2 + \color{green}{3}\cdot X_3 + \color{green}{3}\cdot X_4} {3}   \right)    [\color{green}{\text{each element appears } C_{N-1}^{n-1}=C_3^2=3 \text{ times in the samples}}]\\
										 &amp; = \frac{1}{\color{green}{C_N^n}} \left( \sum_{i=1}^{N}\frac{\color{green}{C_{N-1}^{n-1}}\cdot X_i} {\color{green}{n}}   \right) [\color{green}{\text{generalize to population size=N and sample size=n}}]\\
										 &amp; = \frac{C_{N-1}^{n-1}}{C_N^n\cdot n}\sum_{i=1}^{N}X_i \\
										 &amp;= \frac{1}{N}\sum_{i=1}^{N}X_i  [\color{green}{\text{when N=4, it is }\frac{1}{4} \left(  X_1  + X_2 + X_3 + X_4\right)} ]\\
                     &amp;=\color{blue}{ \textbf{E}(\vec{X})  = \mu}
\end{align*} %]]&gt;&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align*} 
\sigma_{sm}^2 &amp;= \textbf{Var}(\vec{X}_{sm} )  \\
                     &amp;= \frac{1}{4} \sum_{i=1}^{4} \left( \bar{X}_{sm,i} -\mu_{sm} \right)^2 \\
										 &amp;= \frac{1}{4} \sum_{i=1}^{4} \left( \bar{X}_{sm,i} -\mu \right)^2  [\color{green}{\text{as we have demonstrated } \mu_{sm} =\mu}]\\
										 &amp;= \frac{1}{4} \left[ \left( \frac{X_1 + X_2 + X_3} {3} -\mu\right)^2 + 
										                                            \left( \frac{X_1 + X_2 + X_4} {3} -\mu\right)^2 +
																																\left( \frac{X_1 + X_3 + X_4} {3} -\mu\right)^2 +
																																\left( \frac{X_2 + X_3 + X_4} {3} -\mu\right)^2  \right]  \\
										&amp;= \frac{1}{4} \left[ \left( \frac{(X_1-\mu) +(X_2-\mu) + (X_3-\mu)} {3} \right)^2 + 
										                                            \left( \frac{(X_1-\mu) +(X_2-\mu) + (X_4-\mu)} {3} \right)^2 +
																																\left( \frac{(X_1-\mu) +(X_3-\mu) + (X_4-\mu)} {3} \right)^2 +
																																\left( \frac{(X_2-\mu) +(X_3-\mu) + (X_4-\mu)} {3} \right)^2  \right]  \\
										&amp;= \frac{1}{4} \left[ \left( \frac{\color{green}{3}\cdot(X_1-\mu)^2 +
																																												\color{green}{3}\cdot(X_2-\mu)^2 + 
																																												\color{green}{3}\cdot(X_3-\mu)^2 + 
																																												\color{green}{3}\cdot(X_4-\mu)^2 \color{red}{+0}} {3^ 2} \right)  \right] 
																															 [\color{green}{\text{each element appears } C_{N-1}^{n-1}=C_3^2=3 \text{ times in the samples}}, 
																															 \color{red}{\text{assuming all $X_i$ are uncorrelated, so cross terms are neligible}}]\\
										&amp; = \frac{1}{\color{green}{C_N^n}} \left( \sum_{i=1}^{N}\frac{\color{green}{C_{N-1}^{n-1}}\cdot(X_i-\mu)^2} {\color{green}{n^2}}   \right)
										                                          [\color{green}{\text{generalize to population size=N and sample size=n}}]\\
										&amp; = \frac{C_{N-1}^{n-1}}{C_N^n\cdot n^2}\sum_{i=1}^{N}(X_i-\mu)^2 \\
										&amp; = \frac{1}{n}\cdot\frac{1}{N}\sum_{i=1}^{N}(X_i-\mu)^2 \\
										&amp;=\frac{1}{n}\cdot \textbf{Var}(\vec{X})  \\
										&amp;=\color{blue}{\frac{\textbf{Var}(\vec{X}) }{n}=\frac{\sigma^2}{n} }
\end{align*} %]]&gt;&lt;/script&gt;

&lt;p&gt;Q.E.D&lt;/p&gt;

&lt;h1 id=&quot;variance-of-a-sum-equals-the-sum-of-the-variances&quot;&gt;Variance of a sum equals the sum of the variances?&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: in the proof above, we have used the conclusion that &lt;strong&gt;the variance of  a sum equals the sum of the variances&lt;/strong&gt;:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation*}
\textbf{Var} \left(  \sum_{i=1}^{N}X_i \right)=  \sum_{i=1}^{N} \textbf{Var} (X_i) \color{red}{?}
\end{equation*}&lt;/script&gt;

&lt;p&gt;This conclusion is &lt;em&gt;NOT true&lt;/em&gt;  in general. There is a &lt;a href=&quot;https://stats.stackexchange.com/questions/31177/does-the-variance-of-a-sum-equal-the-sum-of-the-variances&quot;&gt;post&lt;/a&gt; that explains this issue. To summarise, starting from the calculation of variance as discussed above: $\textbf{Var}(\vec{X})  = \textbf{E}(\vec{X}^2) - \left[\textbf{E}(\vec{X})  \right]^2$, we can show that&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align*}
\textbf{Var} \left(  \sum_{i=1}^{N}X_i \right) &amp;= \textbf{E} \left(  \left[ \sum_{i=1}^{N}X_i \right]^2\right) - \left[ \textbf{E} \left(  \sum_{i=1}^{N}X_i \right)  \right]^2 \\
                                                                                                  &amp;=\textbf{E} \left(   \sum_{i=1}^{N}\sum_{j=1}^{N}X_i\cdot X_j\right) - \sum_{i=1}^{N}\sum_{j=1}^{N}\textbf{E} (X_i)\cdot \textbf{E} (X_j) \\
																																																	&amp;=\sum_{i=1}^{N}\sum_{j=1}^{N}\textbf{E} \left(   X_i\cdot X_j\right) - \sum_{i=1}^{N}\sum_{j=1}^{N}\textbf{E} (X_i)\cdot \textbf{E} (X_j) \\
																																																	&amp;=\sum_{i=1}^{N}\sum_{j=1}^{N}\left(\textbf{E} \left(   X_i\cdot X_j\right) - \textbf{E} (X_i)\cdot \textbf{E} (X_j) \right)\\
																																																	&amp;=\sum_{i=1}^{N}\sum_{j=1}^{N}\textbf{Cov}(X_i, X_j)\\
\end{align*} %]]&gt;&lt;/script&gt;

&lt;p&gt;Therefore,&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;if the variables are uncorrelated&lt;/strong&gt;, that is, $\textbf{Cov}(X_i, X_j)=0$ for $i\neq j$, then&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation*}
\textbf{Var} \left(  \sum_{i=1}^{N}X_i \right)  =\sum_{i=1}^{N}\sum_{j=1}^{N}\textbf{Cov}(X_i, X_j) = \sum_{i=1}^{N}\textbf{Cov}(X_i, X_i) = \sum_{i=1}^{N}\textbf{Var}(X_i)
\end{equation*}&lt;/script&gt;

&lt;p&gt;&lt;strong&gt;but if the variables are correlated&lt;/strong&gt;, this relation fails in general: for example, suppose $X_1$, $X_2$ are two random variables each with variance $\sigma^2$ and $\textbf{Cov}(X_1,X_2)=\rho$ where $0&amp;lt;\rho&amp;lt;\sigma^2$. Then $\textbf{Var}(X_1 + X_2) = 2\cdot(\sigma^2 + \rho) \neq 2\cdot \sigma^2$, so the identity fails.&lt;/p&gt;
&lt;h1 id=&quot;unbiased-estimator-for-population-variance&quot;&gt;Unbiased estimator for population variance&lt;/h1&gt;
&lt;p&gt;When computing variance from a sample, we use&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation*} 
s^2 = \frac{1}{\color{blue}{n-1}} \sum_{i=1}^{n} \left( X_{sm},i-\mu_{sm} \right)^2
\end{equation*}&lt;/script&gt;

&lt;p&gt;as an&lt;em&gt;unbiased estimator for the population variance&lt;/em&gt; , which means, $\textbf{E}(s^2)=\sigma^2$. Why do we use $n-1$ instead of $n$ here? It is an issue related to &lt;a href=&quot;https://en.wikipedia.org/wiki/Bessel%27s_correction&quot;&gt;Bessel’s correction&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To explain this, let’s take $\textbf{E}(\vec{X}^2) =\textbf{Var}(\vec{X})  + \left[\textbf{E}(\vec{X})  \right]^2$ as assumed knowledge, and assume that variance of a sum equals the sum of the variances (i.e., variables are uncorrelated).&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{align*} 
\textbf{E}\left( \sum_{i=1}^{n} \left( X_{sm,i}-\mu_{sm} \right)^2 \right) 
									&amp;= \textbf{E}\left( \sum_{i=1}^{n}X_{sm,i}^2 - 2\cdot \mu_{sm}\cdot\sum_{i=1}^{n} X_{sm,i} + n\cdot\mu_{sm}^2 \right) \\
									&amp;= \textbf{E}\left( \sum_{i=1}^{n}X_{sm,i}^2 - n\cdot\mu_{sm}^2 \right)  
									[\color{green}{\sum_{i=1}^{n} X_{sm,i}=n\cdot \mu_{sm}}]\\
									&amp;=n\cdot\textbf{E}(X_{sm,i}^2) - n\cdot\textbf{E}(\mu_{sm}^2) \\
									&amp;=n\cdot\left[ \textbf{Var}(X_{sm,i}) + \left(\textbf{E}(X_{sm,i})\right)^2 \right]- n\cdot\left[ \textbf{Var}(\mu_{sm}) + \left(\textbf{E}(\mu_{sm})\right)^2 \right]
									[\color{green}{\textbf{E}(\vec{X}^2) =\textbf{Var}(\vec{X})  + \left[\textbf{E}(\vec{X})  \right]^2}] \\
									&amp;=n\cdot\left(\sigma^2 + \mu_{sm}^2\right) - n\cdot\left(\frac{\sigma^2}{n} + \mu_{sm}^2\right) 
									[\color{green}{\textbf{E}(X_{sm,i})=\mu_{sm}=\textbf{E}(\mu_{sm}); \text{ and } \textbf{Var}(\mu_{sm})=\textbf{Var}(X_{sm,i})/n=\sigma^2/n} \color{red}{ \text{ if we assume variables $X$ are uncorrelated as disscussed above}} ] \\
									&amp;=(n-1)\cdot\sigma^2\\
\end{align*} %]]&gt;&lt;/script&gt;

&lt;p&gt;Therefore we have:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\begin{equation*} 
\textbf{E}\left( \frac{1}{\color{blue}{n-1}}\sum_{i=1}^{n} \left( X_{sm,i}-\mu_{sm} \right)^2 \right) = \sigma^2
\end{equation*}&lt;/script&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="systematic trading" /><category term="statistics" /><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Ernest P. Chan: Winning Strategies and Their Rationale (3)</title><link href="http://localhost:4000/ernest-p-chan-winning-strategies-and-their-rationale-3/" rel="alternate" type="text/html" title="Ernest P. Chan: Winning Strategies and Their Rationale (3)" /><published>2021-04-01T09:52:38+08:00</published><updated>2021-04-01T09:52:38+08:00</updated><id>http://localhost:4000/ernest-p-chan-winning-strategies-and-their-rationale-3</id><content type="html" xml:base="http://localhost:4000/ernest-p-chan-winning-strategies-and-their-rationale-3/">&lt;head&gt;
    &lt;script src=&quot;https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/x-mathjax-config&quot;&gt;
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    &lt;/script&gt;
&lt;/head&gt;

&lt;h1 id=&quot;tests-for-time-series-momentum&quot;&gt;Tests for Time Series Momentum&lt;/h1&gt;

&lt;p&gt;计算时间序列的correlation，首先需要&lt;strong&gt;选取一个time lag&lt;/strong&gt;，站在某个时间点上，我们总会有两个return：过去一段时间(-N)的return，和未来一段时间(+M)的return，我们需要计算在时间序列上两者的相关系数：&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Corr(R(-N, t), R(+M, t)) = \rho(R(-N, t), R(+M, t))&lt;/script&gt;

&lt;p&gt;尽可能尝试不同的(N,M)组合，去找出最optimal（相关系数最大）的look-back period (N) 和holding period (M).&lt;/p&gt;

&lt;p&gt;计算时，需要注意要么look-back period不能重叠，要么holding period不能重叠，如下图所示：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images_in_posts/overlap_lookback_holding.png&quot; alt=&quot;Markdown Image&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;variance-ratio-test&quot;&gt;Variance Ratio test&lt;/h1&gt;
&lt;p&gt;“variance-ratio test”又称作 “F-ratio test” 或者F-test.  F-test 主要表征两个分布的方差的比例&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;F = \frac{s_1^2}{s_2^2}&lt;/script&gt;

&lt;p&gt;其中，$s_1^2=\frac{\sum(x_1-\bar{x}_1)^2}{n_1-1}$， $s_2^2=\frac{\sum(x_2-\bar{x}_2)^2}{n_2-1}$&lt;/p&gt;

&lt;p&gt;Variance-ratio test由Cochrane（1988）年发展，主要用于检测时间序列是否具备均值回归（mean-reverting）的特性。其原理为：若价格时间序列遵从
随机漫步过程，则任意K期的资产回报率的方差（Variance）与时间间隔K成正比。&lt;/p&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="算法交易" /><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">CentOS 7 远程连接GUI界面</title><link href="http://localhost:4000/centos-7-remote-connect-gui/" rel="alternate" type="text/html" title="CentOS 7 远程连接GUI界面" /><published>2021-03-30T17:15:18+08:00</published><updated>2021-03-30T17:15:18+08:00</updated><id>http://localhost:4000/centos-7-remote-connect-gui</id><content type="html" xml:base="http://localhost:4000/centos-7-remote-connect-gui/">&lt;h1 id=&quot;安装vnc-server&quot;&gt;安装vnc-server&lt;/h1&gt;
&lt;p&gt;有了桌面环境，一般可以通过云服务器厂商提供的web终端远程连接进入桌面。用web终端每次都需要打开浏览器，然后登陆云管理后台再连接，比较麻烦。我们采取直接从桌面客户端远程连接的方式，省去打开浏览器和登录云管理后台的操作。&lt;/p&gt;

&lt;p&gt;远程桌面技术有多种，例如VNC, TeamViewer, RDP等，本文使用免费且广泛使用的VNC。&lt;/p&gt;

&lt;p&gt;在服务器上先安装服务端(tigervnc是tightvnc的分支)：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; yum &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; tigervnc-server&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;接着复制一份VNC配置：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; /lib/systemd/system/vncserver@.service /etc/systemd/system/vncserver@:1.service&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;注意上述命令参数重的“@:1”，可以将数字1换成30000内的任意数字，“5900+数字”即为程序的显示（监听）端口，如”@:1”表示监听5901端口。&lt;/p&gt;

&lt;p&gt;编辑该配置文件(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/systemd/system/vncserver@:1.service&lt;/code&gt;)，将文件内的&lt;USER&gt;替换成远程连接时的登录用户名（如果是root，注意将第二个&lt;USER&gt;所在行的&quot;/home&quot;移除掉）。配置示例：&lt;/USER&gt;&lt;/USER&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Unit]
&lt;span class=&quot;nv&quot;&gt;Description&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Remote desktop service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;VNC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;After&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;syslog.target network.target

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Service]
&lt;span class=&quot;nv&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;simple

&lt;span class=&quot;c&quot;&gt;# Clean any existing files in /tmp/.X11-unix environment&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ExecStartPre&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/sh &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/usr/bin/vncserver -kill %i &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 || :'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ExecStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/bin/vncserver_wrapper &amp;lt;USER&amp;gt; %i
&lt;span class=&quot;nv&quot;&gt;ExecStop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/sh &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'/usr/bin/vncserver -kill %i &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 || :'&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Install]
&lt;span class=&quot;nv&quot;&gt;WantedBy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;multi-user.target&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;接下来设置vnc连接密码：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; vncpasswd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;注意连接密码与登录密码不同：连接密码用于显示远程桌面，登录密码用于用户登录系统。&lt;/p&gt;

&lt;p&gt;设置好后，启动vnc服务：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; systemctl daemon-reload
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; systemctl start vncserver@:1
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;vncserver@:1
	&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;如果开启了防火墙，注意放行相应端口（阿里云的话在安全管理控制组进行设置）。&lt;/p&gt;

&lt;h1 id=&quot;客户端连接&quot;&gt;客户端连接&lt;/h1&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;服务端配置完毕，接下来用客户端连接。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;vnc是免费技术，许多客户端都支持该协议。本文采用App Store上免费的“Remote Desktop - VNC”软件进行连接。&lt;/p&gt;

&lt;p&gt;在输入框填写服务器地址：&lt;strong&gt;ip:port&lt;/strong&gt;，其中ip是服务器的ip或域名，port是监听的端口，例如&lt;strong&gt;5901&lt;/strong&gt;。输入后按回车，弹出密码输入框，输入vncpasswd设置的密码。密码正确的话就可以看到服务器的图形桌面。&lt;/p&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="vncserver" /><summary type="html">安装vnc-server 有了桌面环境，一般可以通过云服务器厂商提供的web终端远程连接进入桌面。用web终端每次都需要打开浏览器，然后登陆云管理后台再连接，比较麻烦。我们采取直接从桌面客户端远程连接的方式，省去打开浏览器和登录云管理后台的操作。</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Ernest P. Chan: Winning Strategies and Their Rationale (1)</title><link href="http://localhost:4000/ernest-p-chan-winning-strategies-and-their-rationale-1/" rel="alternate" type="text/html" title="Ernest P. Chan: Winning Strategies and Their Rationale (1)" /><published>2021-02-08T16:26:00+08:00</published><updated>2021-02-08T16:26:00+08:00</updated><id>http://localhost:4000/ernest-p-chan-winning-strategies-and-their-rationale-1</id><content type="html" xml:base="http://localhost:4000/ernest-p-chan-winning-strategies-and-their-rationale-1/">&lt;p&gt;A brief note of Ernest Chan’s book.&lt;/p&gt;

&lt;h1 id=&quot;backtesting-and-automated-execution&quot;&gt;Backtesting and Automated Execution&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;backtest要做对，否则不如不做&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;好的回测平台 (backtesting platform)，应该与好的自动化执行平台 (automated execution platform)相一致 (容易从回测过渡至实盘交易)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;the-importance-of-backtesting&quot;&gt;The Importance of Backtesting&lt;/h2&gt;

&lt;p&gt;为什么别人的策略，到你这就很难重复 (backtest a published strategy)?&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;别人的细节不会告诉你，只有自己亲自backtest一遍，踩了所有的坑，才算pick up了别人的strategy&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;自己实现backtesting，能够让你将别人的策略，跑在真正的out-of-sample的数据集上；如果不work，你很可能可以判断这是一篇水文&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;自己实现backtesting，也是一个改进策略 (refine and improve the strategy)的过程&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;common-pitfalls-of-backtesting&quot;&gt;Common Pitfalls of Backtesting&lt;/h2&gt;

&lt;h3 id=&quot;look-ahead-bias&quot;&gt;Look-ahead Bias&lt;/h3&gt;

&lt;p&gt;任何时候，一个正确的backtesting，都不应该用到未来的数据&lt;/p&gt;

&lt;h3 id=&quot;data-snooping-bias-and-the-beauty-of-linearity&quot;&gt;Data-Snooping Bias and the Beauty of Linearity&lt;/h3&gt;

&lt;p&gt;Data-snooping：用太多参数去过拟合历史数据。怎么解决？&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;严格执行out-of-sample一票否决权（另一种不那么好的方法是：进行cross validation）&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;尽可能减少参数（parameter）。【注意】如果你的策略参数不多，但有很复杂的交易规则，也可能导致data-snooping&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;linear-model-or-nonlinear-model&quot;&gt;Linear Model or Nonlinear Model&lt;/h3&gt;

&lt;p&gt;不要迷信非线性模型，很多时候简单的线性模型，反而更好&lt;/p&gt;

&lt;h3 id=&quot;stock-splits-and-dividend-adjustments&quot;&gt;Stock Splits and Dividend Adjustments&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;拆股N-to-1，股票价格会被稀释N倍：回测时将除权日前的价格除以N（在实盘时也要做类似的处理）&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;派息每股¥d，股票价格会降低¥d：回测时将除权日前的价格减去¥d（在实盘时也要做类似的处理）&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;自己做一次前复权/后复权&lt;/p&gt;

&lt;h3 id=&quot;survivorship-bias-in-stock-database&quot;&gt;Survivorship Bias in Stock Database&lt;/h3&gt;

&lt;p&gt;如果回测的数据里，不包括除牌（delisted）的公司，就存在survivorship bias了。对于mean-reverting long-only的策略而言，这种幸存者偏差的影响尤其重要；对momentum策略而言，影响相对没那么大。&lt;/p&gt;

&lt;p&gt;mean-reverting策略更依赖长期的数据，filter掉退市的股票，变相等于避免了一部分可能不盈利的策略，从而导致回测结果inflated；momentum策略更依赖短期的数据，filter掉退市的股票，变相等于放弃了一部分可能短期内盈利的股票，从而导致回测结果deflated。&lt;/p&gt;

&lt;h3 id=&quot;primary-versus-consolidated-stock-prices&quot;&gt;Primary versus Consolidated Stock Prices&lt;/h3&gt;

&lt;p&gt;一只股票在多个交易所上市，在回测时要留意你用到的是哪个交易所的数据。如果使用consolidated prices做回测，很容易搞不清楚实际交易时到底应该用哪个交易所的价格。&lt;/p&gt;

&lt;p&gt;Bar data某程度上就是一种consolidated data，使用OHLC数据进行回测时，要留意与真实的price feed的区别。&lt;/p&gt;

&lt;p&gt;Tick data可以通过订阅实时数据，自行进行收录（如果技术上做得到的话）。&lt;/p&gt;

&lt;h3 id=&quot;venue-dependence-of-currency-quotes&quot;&gt;Venue Dependence of Currency Quotes&lt;/h3&gt;

&lt;p&gt;外汇市场，不同的venue有不同的报价，如果我们打算在A venue进行交易，那就必须用A venue的历史数据进行回测；如果用B venue的历史数据，那就是一个伪回测，
不具备实际意义。&lt;/p&gt;

&lt;p&gt;如果用quote aggregator做回测的historical data，将来打算交易的venue，一定要在这个aggregator里面，否则也是一个无效的回测。&lt;/p&gt;

&lt;p&gt;外汇市场数据还有一个特点：通常bid/ask quotes数据相对容易获得，但trade price/volume较难获得（因为没有监管要求上报trade数据，大家都会倾向将trade
数据看作是自己的私有财产）&lt;/p&gt;

&lt;h2 id=&quot;short-sale-constraints&quot;&gt;Short-Sale Constraints&lt;/h2&gt;

&lt;p&gt;通常，你的经纪商（broker）未必支持short sale。&lt;/p&gt;

&lt;p&gt;如果short interest足够多，会导致borrow share的成本很高。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;“uptick rule”：short sale的价格要比最近成交价更高。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;futures-continuous-contracts&quot;&gt;Futures Continuous Contracts&lt;/h2&gt;

&lt;p&gt;期货需要考虑roll over&lt;/p&gt;

&lt;h2 id=&quot;futures-close-versus-settlement-prices&quot;&gt;Futures Close versus Settlement Prices&lt;/h2&gt;

&lt;p&gt;Settlement prices由exchange提供，即使当天没有交易，也会有一个settlement prices。用actural transaction prices去做回测比较好，如果用
settlement prices，要小心。&lt;/p&gt;

&lt;h2 id=&quot;statistical-significance-of-backtesting-hypothesis-testing&quot;&gt;Statistical Significance of Backtesting: Hypothesis Testing&lt;/h2&gt;

&lt;h2 id=&quot;choosing-a-backtesting-and-automated-execution-platform&quot;&gt;Choosing a Backtesting and Automated Execution Platform&lt;/h2&gt;

&lt;p&gt;买一个系统还是自己build一个系统？&lt;/p&gt;

&lt;h2 id=&quot;can-backtesting-and-execution-use-the-same-program&quot;&gt;Can Backtesting and Execution Use the Same Program?&lt;/h2&gt;

&lt;p&gt;应该要一致：&lt;/p&gt;

&lt;p&gt;（1）方便将backtest strategy 迁移至实盘live trading（尽可能少的改动代码）&lt;/p&gt;

&lt;p&gt;（2）避免look-ahead bias&lt;/p&gt;

&lt;h2 id=&quot;what-type-of-asset-classes-or-strategies-does-the-platform-support&quot;&gt;What Type of Asset Classes or Strategies Does the Platform Support?&lt;/h2&gt;

&lt;p&gt;市面上已有的平台，通常只能trade一种或几种资产。&lt;strong&gt;自己写会有足够的灵活性&lt;/strong&gt; （例如&lt;a href=&quot;https://github.com/josephchenhk/qtrader&quot;&gt;Qtrader&lt;/a&gt;）。&lt;/p&gt;

&lt;h2 id=&quot;does-the-platform-have-complex-event-processing&quot;&gt;Does the Platform Have Complex Event Processing?&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;For an algorithmic trader, one important point is that the program is event driven, and not bar driven.That is, the program does not go poll prices or news items at the end of each bar and then decide what to do. Because CEP is event driven, there is no delay between the occurrence of an event and the response to it.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Jospeh：这未必是一条金科玉律。很多中低频的systematic trading strategies其实也是由bar驱动的。&lt;/p&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="算法交易" /><category term="qtrader" /><summary type="html">A brief note of Ernest Chan’s book.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">在CentOS安装docker</title><link href="http://localhost:4000/centos-install-docker/" rel="alternate" type="text/html" title="在CentOS安装docker" /><published>2021-02-04T22:48:00+08:00</published><updated>2021-02-04T22:48:00+08:00</updated><id>http://localhost:4000/centos-install-docker</id><content type="html" xml:base="http://localhost:4000/centos-install-docker/">&lt;h1 id=&quot;centos7安装docker详细步骤&quot;&gt;centos7安装Docker详细步骤&lt;/h1&gt;

&lt;p&gt;centos7安装Docker全过程记录（无坑版教程）：&lt;/p&gt;

&lt;h2 id=&quot;一安装前必读&quot;&gt;一、安装前必读&lt;/h2&gt;
&lt;p&gt;在安装 Docker 之前，先说一下配置，我这里是Centos7
 Linux 内核：官方建议 3.10 以上，3.8以上貌似也可。&lt;/p&gt;

&lt;p&gt;注意：本文的命令使用的是 root 用户登录执行，不是 root 的话所有命令前面要加 sudo&lt;/p&gt;

&lt;h3 id=&quot;1查看当前的内核版本&quot;&gt;1.查看当前的内核版本&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;2使用-root-权限更新-yum-包生产环境中此步操作需慎重看自己情况学习的话随便搞&quot;&gt;2.使用 root 权限更新 yum 包（生产环境中此步操作需慎重，看自己情况，学习的话随便搞）&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;注意​ 
yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; update：升级所有包同时也升级软件和系统内核；​ 
yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; upgrade：只升级所有包，不升级软件和系统内核&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;3卸载旧版本如果之前安装过的话&quot;&gt;3.卸载旧版本（如果之前安装过的话）&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;yum remove docker  docker-common docker-selinux docker-engine&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;二安装docker的详细步骤&quot;&gt;二、安装Docker的详细步骤&lt;/h2&gt;

&lt;h3 id=&quot;1安装需要的软件包-yum-util-提供yum-config-manager功能另两个是devicemapper驱动依赖&quot;&gt;1.安装需要的软件包， yum-util 提供yum-config-manager功能，另两个是devicemapper驱动依赖&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;yum &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; yum-utils device-mapper-persistent-data lvm2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;2设置-yum-源&quot;&gt;2.设置 yum 源&lt;/h3&gt;

&lt;p&gt;设置一个yum源，下面两个都可用&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;yum-config-manager &lt;span class=&quot;nt&quot;&gt;--add-repo&lt;/span&gt; http://download.docker.com/linux/centos/docker-ce.repo（中央仓库）

yum-config-manager &lt;span class=&quot;nt&quot;&gt;--add-repo&lt;/span&gt; http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo（阿里仓库）&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;3选择docker版本并安装&quot;&gt;3.选择docker版本并安装&lt;/h3&gt;

&lt;p&gt;####（1）查看可用版本有哪些&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;yum list docker-ce &lt;span class=&quot;nt&quot;&gt;--showduplicates&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;####（2）选择一个版本并安装：&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;yum install docker-ce-版本号&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;docker-ce-20.10.2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;4启动-docker-并设置开机自启&quot;&gt;4.启动 Docker 并设置开机自启&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;systemctl start docker
systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;docker&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;ref&quot;&gt;Ref&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://cloud.tencent.com/developer/article/1701451&quot;&gt;centos7安装Docker详细步骤（无坑版教程）&lt;/a&gt;&lt;/p&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="docker" /><category term="centos" /><summary type="html">centos7安装Docker详细步骤</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Jira服务器搭建</title><link href="http://localhost:4000/jira-server/" rel="alternate" type="text/html" title="Jira服务器搭建" /><published>2020-07-22T15:41:00+08:00</published><updated>2020-07-22T15:41:00+08:00</updated><id>http://localhost:4000/jira-server</id><content type="html" xml:base="http://localhost:4000/jira-server/">&lt;h1 id=&quot;安装jdk&quot;&gt;安装jdk&lt;/h1&gt;

&lt;p&gt;去官网下载jdk-8u261-linux-x64.rpm&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum localinstall jdk-8u261-linux-x64.rpm&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;装之前，如果系统已经有open-jdk，需要先卸装&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-qa&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;java
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--nodeps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;查看到的open-jdk] &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;安装mysql&quot;&gt;安装mysql&lt;/h1&gt;

&lt;p&gt;先检查系统是否有安装mysql&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-qa&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;mysql&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;下载mysql的repo源&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;安装mysql-community-release-el7-5.noarch.rpm包：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-ivh&lt;/span&gt; mysql-community-release-el7-5.noarch.rpm&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;安装完这个包之后，会获得两个mysql的yum repo源：/etc/yum.repos.d/mysql-community.repo, /etc/yum.repos.d/mysql-community-source.repo&lt;/p&gt;

&lt;p&gt;我们便可以运行下面命令去安装mysql&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;mysql-server&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;安装完成后，再次查看mysql&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rpm &lt;span class=&quot;nt&quot;&gt;-qa&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;mysql
mysql-community-libs-5.6.49-2.el7.x86_64
mysql-community-release-el7-5.noarch
mysql-community-common-5.6.49-2.el7.x86_64
mysql-community-client-5.6.49-2.el7.x86_64
mysql-community-server-5.6.49-2.el7.x86_64&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;启动mysqld&quot;&gt;启动mysqld&lt;/h1&gt;

&lt;p&gt;在进行mysql配置之前，先要启动mysql server：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shelll&quot; data-lang=&quot;shelll&quot;&gt;$ service mysqld start&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;设置mysql&quot;&gt;设置mysql&lt;/h1&gt;

&lt;p&gt;首先要重置密码&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root
ERROR 2002 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;HY000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Can&lt;span class=&quot;s1&quot;&gt;'t connect to local MySQL server through socket '&lt;/span&gt;/var/lib/mysql/mysql.sock&lt;span class=&quot;s1&quot;&gt;' (2)

# 这个错误原因是/var/lib/mysql的访问权限问题，将/var/lib/mysql的拥有者改为mysql:mysql
$ ls -l /var/lib/mysql
drwxr-xr-x. 2 mysql mysql 6 Jun 2 02:13 mysql
drwxr-x---. 2 mysql mysql 6 Jun 2 02:13 mysql-files

# 修改子目录的用户组
$ chown mysql:mysql /var/lib/mysql -R

# 再试一次登陆mysql
$ mysql -u root&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;成功以root用户进入mysql&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;c&quot;&gt;# 创建jira数据库&lt;/span&gt;
mysql&amp;gt; CREATE DATABASE jira CHARACTER SET utf8 COLLATE utf8_bin&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
Query OK, 1 row affected &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 授予jira用户权限&lt;/span&gt;
mysql&amp;gt; GRANT ALL PRIVILEGES ON jira.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; TO &lt;span class=&quot;s1&quot;&gt;'jira'&lt;/span&gt;@&lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt; IDENTIFIED BY &lt;span class=&quot;s1&quot;&gt;'jirapass'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
Query OK, 0 rows affected &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 测试jira连接mysql&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-ujira&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-pjirapass&lt;/span&gt;
mysql&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;安装jira&quot;&gt;安装jira&lt;/h1&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget https://www.atlassian.com/software/jira/downloads/binary/atlassian-jira-software-7.4.1-x64.bin

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ll atlassian-jira-software-7.4.1-x64.bin
&lt;span class=&quot;nt&quot;&gt;-rw-rw-r--&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;a+x atlassian-jira-software-7.4.1-x64.bin
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; ./atlassian-jira-software-7.4.1-x64.bin &lt;span class=&quot;c&quot;&gt;# 记得要用sudo&lt;/span&gt;
Installation Directory: /opt/atlassian/jira
Home directory: /var/atlassian/application-data/jira
HTTP Port: 8080
RMI Port:8005&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;先关闭jira，将pojie文件atlassian-extras-3.2.jar 和 mysql-connector-java-5.1.39-bin.jar 两个文件复制至 /opt/atlassian/jira/atlassian-jira/WEB-INF/lib/目录下&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/etc/init.d/jira stop
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;lsof &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;:8080
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;atlassian-extras-3.2.jar /opt/atlassian/jira/atlassian-jira/WEB-INF/lib/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;mysql-connector-java-5.1.39-bin.jar /opt/atlassian/jira/atlassian-jira/WEB-INF/lib/
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/etc/init.d/jira start&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;装好后如果在非本地机，通过ip:8080访问打不开，可能是由于防火墙的缘故，作如下处理&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;firewall-cmd &lt;span class=&quot;nt&quot;&gt;--zone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;public &lt;span class=&quot;nt&quot;&gt;--add-port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8080/tcp &lt;span class=&quot;nt&quot;&gt;--permanent&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;service firewalld stop
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;service firewalld start&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;打开浏览器，输入ip:8080访问jira配置页面，按步骤操作如下：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images_in_posts/jira1.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira2.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira3.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira4.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira5.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira6.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira7.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira8.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira9.png&quot; alt=&quot;Markdown Image&quot; /&gt;
&lt;img src=&quot;/assets/images_in_posts/jira10.png&quot; alt=&quot;Markdown Image&quot; /&gt;&lt;/p&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="Jira" /><category term="server" /><summary type="html">安装jdk</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">GitLab服务器搭建</title><link href="http://localhost:4000/gitlab-server/" rel="alternate" type="text/html" title="GitLab服务器搭建" /><published>2020-07-21T12:41:00+08:00</published><updated>2020-07-21T12:41:00+08:00</updated><id>http://localhost:4000/gitlab-server</id><content type="html" xml:base="http://localhost:4000/gitlab-server/">&lt;p&gt;我们上一篇介绍了搭建Git服务器。要使用一个更现代、功能更全的Git服务器，我们可以试试GitLab&lt;/p&gt;
&lt;h1 id=&quot;准备工作&quot;&gt;准备工作&lt;/h1&gt;

&lt;ol&gt;
  &lt;li&gt;安装基础依赖&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;c&quot;&gt;# 安装技术依赖&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; curl policycoreutils-python openssh-server

&lt;span class=&quot;c&quot;&gt;# 启动ssh服务 &amp;amp; 设置为开机启动&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl enabale sshd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start sshd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;安装Postfix&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Postfix是一个邮件服务器，GitLab发送邮件需要用到&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;c&quot;&gt;# 安装postfix&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; postfix

&lt;span class=&quot;c&quot;&gt;# 启动postfix并设置为开机启动&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;postfix
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start postfix&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;开放ssh以及http服务（80端口）&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;c&quot;&gt;# 开放ssh、http服务&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;firewall-cmd &lt;span class=&quot;nt&quot;&gt;--add-service&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;--permanent&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;firewall-cmd &lt;span class=&quot;nt&quot;&gt;--add-service&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;http &lt;span class=&quot;nt&quot;&gt;--permanent&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 重载防火墙规则&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;firewall-cmd &lt;span class=&quot;nt&quot;&gt;--reload&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;部署过程&quot;&gt;部署过程&lt;/h1&gt;

&lt;p&gt;我们这里部署社区版gitlab-ce，如果要部署商业版可以把关键字替换成gitlab-ee&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;yum安装gitlab&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;bash 
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; gitlab-ce&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;配置GitLab站点Url&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;将external_url修改为ip地址或域名：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;c&quot;&gt;# 修改配置文件&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi /etc/gitlab/gitlab.rb

&lt;span class=&quot;c&quot;&gt;# 配置首页地址 (注意有个等号=)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;external_url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'10.10.10.82'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;启动并访问GitLab&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;c&quot;&gt;# 重新配置并启动&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gitlab-ctl reconfigure

&lt;span class=&quot;c&quot;&gt;# 完成后将会看到如下输出&lt;/span&gt;
Running handlers &lt;span class=&quot;nb&quot;&gt;complete
&lt;/span&gt;Chef Client finished, 556/1522 resources updated &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;05 minutes 34 seconds
gitlab Reconfigured!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;直接在浏览器输入ip地址”10.10.10.82”，可以访问gitlab。也可以通过修改本地host将域名指向服务器ip：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi /etc/hosts

10.10.10.82 www.algo-git.com&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;以上修改后，重启network&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-shell&quot; data-lang=&quot;shell&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl restart network

&lt;span class=&quot;c&quot;&gt;# 或者通过nscd清除dns缓存&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;nscd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl status nscd
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start nscd

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nscd &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; hosts&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;注意：以上修改/etc/hosts 只能对修改的本机生效。如果要对所有机器生效，还是要老老实实地去注册一个域名，然后通过dns解析吧。&lt;/p&gt;</content><author><name>joseph</name></author><category term="blog" /><category term="GitLab" /><category term="server" /><summary type="html">我们上一篇介绍了搭建Git服务器。要使用一个更现代、功能更全的Git服务器，我们可以试试GitLab 准备工作</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/images/markdown.jpg" /><media:content medium="image" url="http://localhost:4000/assets/images/markdown.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>